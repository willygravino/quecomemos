
<div class="modal fade" id="ingredienteModal" tabindex="-1" aria-labelledby="ingredienteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      
      <div class="modal-header">
        <h5 class="modal-title" id="ingredienteModalLabel">Agregar Ingrediente</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      
      <div class="modal-body">
        


        <!-- ====== Elegir existente o crear nuevo ====== -->
        <div class="mb-3">
        <div class="form-check form-switch d-flex align-items-center">
          <input class="form-check-input me-2" type="checkbox" id="toggle-nuevo-ingrediente">
          <label class="form-check-label mb-0" for="toggle-nuevo-ingrediente">
            Cargar un ingrediente nuevo
          </label>
        </div>
      </div>



        <!-- ========== EXISTENTE (Select2) ========== -->
        <!-- Tu select actual queda envuelto en este bloque -->
        <div id="bloque-existente">
          <div class="mb-3">
            <label for="modal-nombre" class="form-label">Ingrediente (existente)</label>
            <select id="modal-nombre" class="form-select" style="width:100%"></select>
          </div>
        </div>

        <!-- ========== NUEVO (campos del modelo) ========== -->
        <div id="bloque-nuevo" class="border rounded p-3 bg-light d-none">
          <div class="mb-3">
            <label for="nuevo-nombre" class="form-label">Nombre</label>
            <input type="text" id="nuevo-nombre" class="form-control" placeholder="Ej.: Zanahoria">
          </div>

          <div class="mb-3">
            <label for="nuevo-tipo" class="form-label">Tipo (lugar/categoría)</label>
            <select id="nuevo-tipo" class="form-select">
              <option value="verduleria">Verdulería</option>
              <option value="fiambreria">Fiambriería</option>
              <option value="carniceria">Carnicería</option>
              <option value="pescaderia">Pescadería</option>
              <option value="panaderia">Panadería</option>
              <option value="almacen">Almacén</option>
              <option value="lacteos">Lácteos</option>
              <option value="bebidas">Bebidas</option>
              <option value="otro" selected>Otro</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="nuevo-detalle" class="form-label">Detalle (subcategoría)</label>
            <select id="nuevo-detalle" class="form-select">
              <option value="">— (opcional)</option>
            </select>
          </div>

          <div class="alert alert-warning d-none" id="nuevo-ingrediente-errores"></div>
        </div>

        <!-- (Dejás tal cual) Cantidad -->
        <div class="mb-3">
          <label for="modal-cantidad" class="form-label">Cantidad</label>
          <input type="text" id="modal-cantidad" class="form-control">
        </div>

        <!-- (Dejás tal cual) Unidad visible -->
        <div class="mb-3">
          <label for="modal-unidad" class="form-label">Unidad</label>
          <select id="modal-unidad" name="modal-unidad" class="form-select">
            {% for value, label in ingrediente_formset.empty_form.unidad.field.choices %}
              <option value="{{ value }}">{{ label }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- (Dejás tal cual) Prototype oculto -->
        <div id="unidad-prototype" class="d-none">
          <select name="ingredientes_en_plato-__prefix__-unidad"
                  class="form-select form-select-sm w-100 w-sm-auto"
                  disabled>
            {% for value, label in ingrediente_formset.empty_form.unidad.field.choices %}
              <option value="{{ value }}">{{ label }}</option>
            {% endfor %}
          </select>
        </div>

      </div>

        
      <!-- </div> -->
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" id="guardarIngrediente">Guardar</button>
      </div>
      
    </div>
  </div>
</div>