{% extends "AdminVideos/index.html" %}

{% load static %}

{% block un_video %}


{% if tipo_de_vista_estable == "random-todos" or tipo_de_vista_estable == "random-con-mios" %}
  <h6>CANTIDAD DE PLATOS SUGERIDOS {{ cantidad_platos_sugeridos }}</h6>
  <h6>CANTIDAD SUGERIBLES SEGUN FILTRO {{ cantidad_platos_sugeribles }}</h6>
  {% if cantidad_platos_sugeridos >= cantidad_platos_sugeribles %}
    <h6>No hay más platos para sugerir.</h6>
    <form action="{% url 'reiniciar-sugeridos' %}" method="GET">
      <input type="checkbox" id="borrar-sugeribles" name="borrar-lista-sugeribles" value="borrar-sugeribles"
        checked>
      <button type="submit">Reiniciar sugeribles para volver a sugerir</button>
    </form>
  {% endif %}
{% endif %}


<section>
  {% if not platos %}
    <h6>No hay platos para mostrar.</h6>
  {% else %}
      <div class="row">
        <div class="col">
          <div class="p-1 d-flex flex-wrap">
            <div class=" d-flex justify-content-center align-items-center">
            <!-- <a class="bg-primary" href="{% url 'videos-create' %}"> -->
              <a class="bg-primary m-3 text-white p-2 small border border-dark" href="{% url 'videos-create' %}?tipopag={{ request.GET.tipopag|default:'' }}">
                AGREGAR{% if request.GET.tipopag %} {{ request.GET.tipopag }}{% else %} PLATO{% endif %}
            </a>
              <!-- <a class="bg-primary m-3 text-white p-2 small border border-dark" href="{% url 'videos-create' %}?tipopag={{ request.GET.tipopag }}">AGREGAR {% if request.GET.tipopag != "ppal" %}{{ request.GET.tipopag }} {% else %} PLATO {% endif %}

              </a> -->

               <!-- <div class="m-3 text-white p-2 small border border-dark"> 
             <a class="nav-link"  href="#" data-toggle="modal" data-target="#IngresoModal"> 
                 <p>AGREGAR PLATO</p>
               </div> -->
            </a>                        
          </div>

            {% for plato in platos %}
            <div class="d-flex flex-row">
              <div class="col-md-4 mb-3">
                <div class="card" style="width: 10rem;">
                  <div class="container p-0">
                      <a href="{% url 'videos-detail' plato.id %}">
                        <img src="{{plato.image_url}}" class="img-fluid position-relative object-fit-cover" alt="Imagen del Plato">
                      </a>                        
                      <div class="position-absolute top-0 start-50 translate-middle-x p-2 text-center text-white bg-dark bg-opacity-10 rounded">
                          <h6 class="mb-0 small"> {{ plato.nombre_plato }} </h6>
                      </div>
                  </div>
                  <div class="mt-1">
                      {% if user.id != plato.propietario.id %}
                        <small class="text-muted">Subido por {{ plato.propietario }}</small>
                      {% endif %}
                      <br>
                      <small class="mtext-success"> {{ plato.tipo }} /</small>

                      {% for key, value in plato.variedades.items %}

                          {% if value.variedad %}
                            <small class="mtext-success"> {{ value.variedad }} /</small>
                          {% endif %}
                      {% endfor %}

                      <form action="{% url 'plato-elegido' %}" method="GET">
                        <input type="hidden" id="opcion{{ plato.id }}" name="opcion1" value="{{ plato.nombre_plato }}">
                      <input type="hidden" name="tipo-plato" value="{{ plato.tipo }}">   <!--  Incluir tipo-plato -->

                        <input type="hidden" name="tipopag" value="{{ request.GET.tipopag }}">  <!-- Incluir tipo-pag -->
                    
                        {% if plato.nombre_plato in elegidos %}
                            <input type="checkbox" id="borrar" name="borrar" value="borrar" checked style="display: none;">
                            <button type="submit" class="btn btn-success" style="font-size: 12px; padding: 2px 5px;">√</button>
                        {% else %}
                            <input type="checkbox" id="opcion{{ plato.id }}" name="opcion1" value="{{ plato.nombre_plato }}" checked style="display: none;">
                            <button type="submit" class="btn btn-primary"  style="font-size: 12px; padding: 2px 5px;">Preseleccionar</button>
                        {% endif %}
                    </form>

                   </div>

                </div>
             </div>
           </div>

          {% endfor %}
          </div>
        </div>
      </div>
    {% endif %}



</section>



<div class="container">

  <div class="row">
      <div class="col">

        <!-- <h1> pre-elegidos: {{ elegidos }} </h1>
        <h1> principales presel: {{ principales_presel }} </h1>
        <h1> guarnic: {{ guarniciones_presel }} </h1> -->


        <!-- <p >PLATOS ELEGIDOS POR DÍA LISTA {{platos_elegidos_por_dia_lista }}</p> -->


        <div class="d-flex flex-wrap justify-content-between">

        <a href="{% url 'formulario-dia' dia=dias_desde_hoy.0.0|date:'Y-m-d' %}" class= {% if platos_elegidos_por_dia_lista.0.1.almuerzo != None or platos_elegidos_por_dia_lista.0.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %} >
            <div class="mb-0 text-white p-2 small border border-dark">
              <p >{{ dias_desde_hoy.0.0|date:"l j" }}</p>
              <p >Almuerzo: {{platos_elegidos_por_dia_lista.0.1.almuerzo}}</p>
              <p >Cena: {{platos_elegidos_por_dia_lista.0.1.cena}}</p>
            </div>
        </a>

        <a href="{% url 'formulario-dia' dia=dias_desde_hoy.1.0|date:'Y-m-d' %}" class={% if platos_elegidos_por_dia_lista.1.1.almuerzo != None or platos_elegidos_por_dia_lista.1.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %}>
            <div class="mb-0 text-white p-2 small border border-dark"> 
              <p>{{ dias_desde_hoy.1.0|date:"l j" }}</p>
              <p >Almuerzo: {{platos_elegidos_por_dia_lista.1.1.almuerzo}}</p>
              <p >Cena: {{platos_elegidos_por_dia_lista.1.1.cena}}</p>
            </div>
          </a>
          

          <a href="{% url 'formulario-dia' dia=dias_desde_hoy.2.0|date:'Y-m-d' %}" class={% if platos_elegidos_por_dia_lista.2.1.almuerzo != None or platos_elegidos_por_dia_lista.2.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %}>
           <div class="mb-0 text-white p-2 small border border-dark"> 
            <p>{{ dias_desde_hoy.2.0|date:"l j" }}</p>
            <p >Almuerzo: {{platos_elegidos_por_dia_lista.2.1.almuerzo}}</p>
            <p >Cena: {{platos_elegidos_por_dia_lista.2.1.cena}}</p>
           </div>
          </a>

          <a href="{% url 'formulario-dia' dia=dias_desde_hoy.3.0|date:'Y-m-d' %}" class={% if platos_elegidos_por_dia_lista.3.1.almuerzo != None or platos_elegidos_por_dia_lista.3.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %}>
            <div class="mb-0 text-white p-2 small border border-dark"> 
              <p>{{ dias_desde_hoy.3.0|date:"l j" }}</p>
              <p >Almuerzo: {{platos_elegidos_por_dia_lista.3.1.almuerzo}}</p>
              <p >Cena: {{platos_elegidos_por_dia_lista.3.1.cena}}</p>
            </div>
          </a>

          <a href="{% url 'formulario-dia' dia=dias_desde_hoy.4.0|date:'Y-m-d' %}" class={% if platos_elegidos_por_dia_lista.4.1.almuerzo != None or platos_elegidos_por_dia_lista.4.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %}>
            <div class="mb-0 text-white p-2 smal border border-dark"> 
              <p>{{ dias_desde_hoy.4.0|date:"l j" }}</p>
              <p >Almuerzo: {{platos_elegidos_por_dia_lista.4.1.almuerzo}}</p>
              <p >Cena: {{platos_elegidos_por_dia_lista.4.1.cena}}</p>
            </div>
          </a>

          <a href="{% url 'formulario-dia' dia=dias_desde_hoy.5.0|date:'Y-m-d' %}" class={% if platos_elegidos_por_dia_lista.5.1.almuerzo != None or platos_elegidos_por_dia_lista.5.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %}>
            <div class="mb-0 text-white p-2 small border border-dark"> 
              <p>{{ dias_desde_hoy.5.0|date:"l j" }}</p>
              <p >Almuerzo: {{platos_elegidos_por_dia_lista.5.1.almuerzo}}</p>
              <p >Cena: {{platos_elegidos_por_dia_lista.5.1.cena}}</p>
            </div>
          </a>

          <a href="{% url 'formulario-dia' dia=dias_desde_hoy.6.0|date:'Y-m-d' %}" class={% if platos_elegidos_por_dia_lista.6.1.almuerzo != None or platos_elegidos_por_dia_lista.6.1.cena != None %} "bg-success" {% else %}"bg-primary" {% endif %}>
            <div class="mb-0 text-white p-2 small border border-dark"> 
              <p>{{ dias_desde_hoy.6.0|date:"l j" }}</p>
              <p >Almuerzo: {{platos_elegidos_por_dia_lista.6.1.almuerzo}}</p>
              <p >Cena: {{platos_elegidos_por_dia_lista.6.1.cena}}</p>
            </div>
          </a>

        </div>
      </div>
  </div>
</div>

{% endblock %}